<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; connect-src 'self' https://*.supabase.co wss://*.supabase.co https://esm.sh; base-uri 'self'; form-action 'self'" />
  <title>klettrack Web App</title>
  <meta name="description" content="klettrack authenticated workspace" />
  <style>
    :root {
      color-scheme: light;
      --bg: #f5f7fb;
      --panel: #ffffff;
      --card: #ffffff;
      --text: #0f172a;
      --muted: #475569;
      --brand: #2563eb;
      --brand-strong: #1d4ed8;
      --brand-contrast: #ffffff;
      --action: #f0c000;
      --action-strong: #d4a800;
      --action-contrast: #111111;
      --border: #dbe3ef;
      --radius: 16px;
    }
    :root[data-theme="dark"] {
      color-scheme: dark;
      --bg: #000000;
      --panel: #050508;
      --card: #101010;
      --text: #f5f5f5;
      --muted: #a3a3a3;
      --brand: #f0c000;
      --brand-strong: #c89f00;
      --brand-contrast: #111111;
      --action: #f0c000;
      --action-strong: #c89f00;
      --action-contrast: #111111;
      --border: #1f2632;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font: 400 16px/1.55 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      text-rendering: optimizeLegibility;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    a { color: var(--brand); }
    .container {
      max-width: 2040px;
      margin: 0 auto;
      padding: 20px 24px;
    }
    .topbar {
      border-bottom: 1px solid var(--border);
      background: var(--panel);
    }
    .topbar-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 14px 20px;
      max-width: 2040px;
      margin: 0 auto;
    }
    .title {
      margin: 0;
      font-size: 20px;
      display: inline-flex;
      align-items: center;
      gap: 10px;
    }
    .brand-mark {
      width: 24px;
      height: 24px;
      border-radius: 6px;
      object-fit: cover;
      border: 1px solid color-mix(in srgb, var(--brand) 30%, var(--border));
      flex-shrink: 0;
    }
    .card {
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--card);
      padding: 16px;
      margin-top: 18px;
    }
    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }
    .pill {
      border: 1px solid var(--border);
      border-radius: 999px;
      padding: 6px 10px;
      color: var(--muted);
      font-size: 13px;
    }
    .input, .btn {
      border-radius: 10px;
      border: 1px solid var(--border);
      background: var(--panel);
      color: var(--text);
      font: inherit;
      padding: 10px 12px;
    }
    .input {
      width: 100%;
    }
    .btn {
      cursor: pointer;
      font-weight: 500;
    }
    .btn.primary {
      background: linear-gradient(135deg, var(--action), var(--action-strong));
      border-color: transparent;
      color: var(--action-contrast);
      font-weight: 600;
    }
    .btn.link {
      background: transparent;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .nav-icon {
      width: 14px;
      height: 14px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      opacity: 0.9;
    }
    .sync-action {
      background: linear-gradient(135deg, var(--action), var(--action-strong));
      border-color: var(--action-strong);
      color: var(--action-contrast);
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    :root[data-theme="dark"] .sync-action {
      background: linear-gradient(135deg, #2563eb, #1e40af);
      border-color: #1e40af;
      color: #e2e8f0;
    }
    @media (hover: hover) and (pointer: fine) {
      .sync-action:hover {
        border-color: #9f7e00;
        background: linear-gradient(135deg, #e3b300, #c08f00);
      }
      :root[data-theme="dark"] .sync-action:hover {
        border-color: #1e40af;
        background: linear-gradient(135deg, #1d4ed8, #1e3a8a);
      }
    }
    .theme-action {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .error {
      color: #ef4444;
      font-size: 14px;
    }
    .muted {
      color: var(--muted);
    }
    .hidden {
      display: none;
    }
    .site-footer {
      border-top: 1px solid var(--border);
      margin-top: 24px;
      padding: 20px 24px 28px;
      color: var(--muted);
      background: var(--panel);
    }
    .site-footer-inner {
      max-width: 2040px;
      margin: 0 auto;
      font-size: 14px;
      line-height: 1.5;
    }
    .site-footer-links {
      margin-top: 8px;
    }
    .site-footer-links a {
      color: var(--brand);
      text-decoration: none;
    }
    .site-footer-links a:hover {
      text-decoration: underline;
    }
    .main-nav {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .mobile-nav {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 40;
      display: none;
      grid-template-columns: repeat(5, minmax(0, 1fr));
      border-top: 1px solid var(--border);
      background: color-mix(in srgb, var(--panel) 92%, transparent);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
    }
    .mobile-nav .nav-link {
      border: 0;
      border-radius: 0;
      padding: 9px 6px;
      text-align: center;
      font-size: 12px;
      color: var(--muted);
      text-decoration: none;
      display: grid;
      gap: 2px;
      justify-items: center;
      touch-action: manipulation;
    }
    .mobile-nav .nav-link.active {
      color: var(--brand);
      font-weight: 600;
      background: color-mix(in srgb, var(--brand) 10%, transparent);
    }
    @media (max-width: 900px) {
      .main-nav {
        display: none;
      }
      .mobile-nav {
        display: grid;
      }
      body {
        padding-bottom: 56px;
      }
      .sync-action {
        padding: 8px 10px;
      }
    }
  </style>
  <link rel="stylesheet" href="/web/css/app.css" />
</head>
<body class="webapp">
  <header class="topbar">
    <div class="topbar-inner">
      <h1 class="title">
        <img class="brand-mark" src="/ClimbingProgram/Assets.xcassets/AppIcon.appiconset/icon_60x60.png" alt="Klettrack" width="24" height="24" loading="eager" fetchpriority="high" />
        <span>klettrack Web</span>
      </h1>
      <div class="row">
        <nav class="main-nav" aria-label="Primary">
          <a class="btn link nav-link" data-route="/catalog" href="#/catalog"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg></span><span>Catalog</span></a>
          <a class="btn link nav-link" data-route="/data-manager" href="#/data-manager"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M4 7h16"/><path d="M4 12h16"/><path d="M4 17h16"/></svg></span><span>Data Manager</span></a>
          <a class="btn link nav-link" data-route="/plans" href="#/plans"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8"><rect x="3" y="4" width="18" height="17"/><path d="M8 2v4"/><path d="M16 2v4"/><path d="M3 9h18"/></svg></span><span>Training Plans</span></a>
          <a class="btn link nav-link" data-route="/logs" href="#/logs"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M5 4h12a2 2 0 0 1 2 2v14H7a2 2 0 0 0-2 2z"/><path d="M7 4v16"/><path d="M10 8h6"/><path d="M10 12h6"/></svg></span><span>Logs</span></a>
          <a class="btn link nav-link" data-route="/account" href="#/account"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1 1 0 0 0 .2 1.1l.1.1a1.5 1.5 0 1 1-2.1 2.1l-.1-.1a1 1 0 0 0-1.1-.2 1 1 0 0 0-.6.9V19a1.5 1.5 0 1 1-3 0v-.2a1 1 0 0 0-.6-.9 1 1 0 0 0-1.1.2l-.1.1a1.5 1.5 0 1 1-2.1-2.1l.1-.1a1 1 0 0 0 .2-1.1 1 1 0 0 0-.9-.6H5a1.5 1.5 0 1 1 0-3h.2a1 1 0 0 0 .9-.6 1 1 0 0 0-.2-1.1l-.1-.1a1.5 1.5 0 1 1 2.1-2.1l.1.1a1 1 0 0 0 1.1.2 1 1 0 0 0 .6-.9V5a1.5 1.5 0 1 1 3 0v.2a1 1 0 0 0 .6.9 1 1 0 0 0 1.1-.2l.1-.1a1.5 1.5 0 1 1 2.1 2.1l-.1.1a1 1 0 0 0-.2 1.1 1 1 0 0 0 .9.6H19a1.5 1.5 0 1 1 0 3h-.2a1 1 0 0 0-.9.6z"/></svg></span><span>Account</span></a>
        </nav>
        <button id="theme-btn" class="btn theme-action" type="button" aria-label="Toggle Theme" title="Toggle Theme"><span id="theme-icon" class="nav-icon" aria-hidden="true"></span></button>
        <button id="sync-btn" class="btn sync-action hidden" type="button" aria-label="Sync Data"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M21 12a9 9 0 1 1-2.6-6.4"/><path d="M21 4v6h-6"/></svg></span><span>Sync</span></button>
        <button id="logout-btn" class="btn hidden" type="button">Sign Out</button>
      </div>
    </div>
  </header>

  <main class="container">
    <section id="sync-onboarding-banner" class="sync-onboarding-banner hidden" role="status" aria-live="polite"></section>
    <div id="status" class="pill">Checking session...</div>
    <section id="conflict-panel" class="card hidden"></section>
    <section id="app-view" class="card"></section>
  </main>
  <footer class="site-footer">
    <div class="site-footer-inner">
      <strong>klettrack</strong> — Train smarter. Climb stronger.<br />
      <span class="muted">© 2026 klettrack.</span>
      <div class="site-footer-links">
        <a href="/privacy.html">Privacy Policy</a> ·
        <a href="/terms.html">Terms &amp; Conditions</a>
      </div>
    </div>
  </footer>
  <nav class="mobile-nav" aria-label="Mobile Primary">
    <a class="nav-link" data-route="/catalog" href="#/catalog"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg></span><span>Catalog</span></a>
    <a class="nav-link" data-route="/data-manager" href="#/data-manager"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M4 7h16"/><path d="M4 12h16"/><path d="M4 17h16"/></svg></span><span>Data</span></a>
    <a class="nav-link" data-route="/plans" href="#/plans"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8"><rect x="3" y="4" width="18" height="17"/><path d="M8 2v4"/><path d="M16 2v4"/><path d="M3 9h18"/></svg></span><span>Plans</span></a>
    <a class="nav-link" data-route="/logs" href="#/logs"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M5 4h12a2 2 0 0 1 2 2v14H7a2 2 0 0 0-2 2z"/><path d="M7 4v16"/><path d="M10 8h6"/><path d="M10 12h6"/></svg></span><span>Logs</span></a>
    <a class="nav-link" data-route="/account" href="#/account"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1 1 0 0 0 .2 1.1l.1.1a1.5 1.5 0 1 1-2.1 2.1l-.1-.1a1 1 0 0 0-1.1-.2 1 1 0 0 0-.6.9V19a1.5 1.5 0 1 1-3 0v-.2a1 1 0 0 0-.6-.9 1 1 0 0 0-1.1.2l-.1.1a1.5 1.5 0 1 1-2.1-2.1l.1-.1a1 1 0 0 0 .2-1.1 1 1 0 0 0-.9-.6H5a1.5 1.5 0 1 1 0-3h.2a1 1 0 0 0 .9-.6 1 1 0 0 0-.2-1.1l-.1-.1a1.5 1.5 0 1 1 2.1-2.1l.1.1a1 1 0 0 0 1.1.2 1 1 0 0 0 .6-.9V5a1.5 1.5 0 1 1 3 0v.2a1 1 0 0 0 .6.9 1 1 0 0 0 1.1-.2l.1-.1a1.5 1.5 0 1 1 2.1 2.1l-.1.1a1 1 0 0 0-.2 1.1 1 1 0 0 0 .9.6H19a1.5 1.5 0 1 1 0 3h-.2a1 1 0 0 0-.9.6z"/></svg></span><span>Account</span></a>
  </nav>

  <script defer src="/web/js/appInit.js"></script>
  <script type="module" src="/web/js/bootstrap.js"></script>
</body>
</html>
